<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hyperliquid Point Value</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
        :root {
            --bs-primary: rgb(80, 210, 193);
        }
        body {
            background-color: #102624;
            color: #000;
        }
        .table {
            color: #fff;
        }
        .table thead th {
            color: var(--bs-primary);
        }
        .accent-color {
            color: var(--bs-primary);
        }
        .emoji {
            margin-right: 5px;
            font-size: 14px;
        }
        .price-cell {
            text-align: right;
        }
        a {
            color: var(--bs-primary);    
            text-decoration: underline;
        }
        h1 {
            font-family: 'OurFont', sans-serif;
            color: #000;
        } 
        .full-width-table{
          width: 100%;
        }
        .container {
            max-width: 600px;
        }
  </style>
</head>
<body>
  <div class="container">
    <div class="row justify-content-center">
      <div class="mx-auto my-5">
        <table class="table table-dark full-width-table">
          <thead>
            <tr>
              <th>
                <div class="text-center">
                  <p class="fs-5">Hyperliquid Point Value</p>
                </div>
              </th>
            </tr>
            <tr>
              <td>
                These prices are for reference only. Listing is not constitute endorsement or financial advice.
                 This was put together by <a href="https://twitter.com/stalequant" target="_blank">stalequant</a> who is not affiliated with <a href="https://hyperliquid.xyz" target="_blank">hyperliquid.xyz</a>.
                  Comps are the FDV or market cap of other exchanges, scaled by their size relative to Hyperliqiud. EG: If HL has ten times as much volume as Drift, we assume that HL's FDV will be ten times as big. Data for comparables from <a href="coingecko.com/">CoinGecko</a> and <a href="https://defillama.com/derivatives">Defillama</a>, all data fetched live.
              </td>
            </tr>
          </thead>
        </table>

        <table class="table table-dark full-width-table " >
          <thead>
            <tr>
              <th colspan="2" >Date of TGE</th></th>
            </tr>
          </thead>
          <tr>
            <th >Source</th>
            <th class="price-cell">Month</th>
          </tr>
          <tbody id="markets_tgedate">
            <!-- Rows will be added here by JavaScript -->
          </tbody> 
        </table>

        
        <table class="table table-dark full-width-table ">
          <thead>
            <tr>
              <th colspan="2" >Fully diluted valuation</th>
            </tr>
          </thead>
          <tr>
            <th >Source</th>
            <th class="price-cell">FDV</th>
          </tr>
          <tbody id="markets_fdv">
            <!-- Rows will be added here by JavaScript -->
          </tbody>
 
        </table>


        <table class="table table-dark full-width-table ">
          <thead>
            <tr>
              <th colspan="3">Points</th>
            </tr>
          </thead>
              <tr>
                <th >Source</th>
                <th  class="price-cell">Price</th>
              </tr>
            <tr>
              <td>
                <span class="emoji">üí©</span><a href="https://app.aevo.xyz/perpetual/hype" target="_blank">AEVO (inferred from FDV)</a>
              </td> 
              <td id="aevoI" class="price-cell">Loading...</td>
            </tr>
            <tr>
              <td>
                <span class="emoji">‚õ©Ô∏è</span><a href="https://www.gate.io/pre-market/HYPE" target="_blank">Gate.io (inferred from FDV)</a>
              </td> 
              <td id="gateI" class="price-cell">Loading...</td>
            </tr>
            <tr>
              <td>
                <span class="emoji">üßÆ</span><a href="https://www.investopedia.com/articles/investing/080913/equity-valuation-comparables-approach.asp" target="_blank">Comps (inferred from FDV)</a>
              </td> 
              <td id="compsI" class="price-cell">Loading...</td>
            </tr>
            <tr>
              <td colspan="3" style="padding-left: 20px;" class="form-range">‚Üí assuming <input type="range" id="mySlider" min="0" max="58" value="25" oninput="updatePointFDVBasedOnSliderAndValues()"> <span id="sliderValue">25%</span> of FDV given to points</td>
            </tr>
            <tbody id="point_markets">
          </tbody>
        </table>


    <table class="table table-dark full-width-table " >
          <thead>
            <tr>
              <th colspan="3">Fully diluted valuation <a href="https://www.investopedia.com/articles/investing/080913/equity-valuation-comparables-approach.asp" target="_blank">comps</a></th>
            </tr>
          </thead>
            <tr>
                <th>Comparable</th>
                <th class="price-cell">TVL-implied FDV</th>
                <th class="price-cell">ADV-implied FDV (7D)</th>
            </tr>
          <tbody id="comparables_fdv" >
            <!-- Rows will be added here by JavaScript -->
        </tbody>
    </table>

    <table class="table table-dark full-width-table" >
          <thead>
            <tr>
              <th colspan="5">Market cap <a href="https://www.investopedia.com/articles/investing/080913/equity-valuation-comparables-approach.asp" target="_blank">comps</a></th>
            </tr>
          </thead>
            <tr>
                <th>Comparable</th>
                <th class="price-cell">TVL-implied MC</th>
                <th class="price-cell">ADV-implied MC (7D)</th>
            </tr>
          <tbody id="comparables_mc" >
            <!-- Rows will be added here by JavaScript -->
        </tbody>
    </table>
      </div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script> 
  <script>

        
        function predictions() {
            const allPredictions = [
                {
                    emoji: 'üêµ',
                    link: 'https://x.com/blocmatesdotcom/status/1861855649778249999/photo/1',
                    text: 'blocmates',
                    value: '$3.05-4.85b',
                    where: 'markets_fdv'
                },
                {
                    emoji: 'üéØ',
                    link: 'https://x.com/defi_monk/status/1856019835316002998',
                    text: 'MONK @ Messari (2027 prediction)',
                    value: '$3.00-34.00b',
                    where: 'markets_fdv'
                },
                {
                    emoji: 'üéØ',
                    link: 'https://x.com/tempst0/status/1861697359853347098',
                    text: 'tempst0 (prediction)',
                    value: '$3.50-5.00b',
                    where: 'markets_fdv'
                },
                {
                    emoji: 'üéØ',
                    link: 'https://x.com/asxn_r/status/1838299623670112749/photo/1',
                    text: 'asxn (prediction)',
                    value: '$2.00-4.25b',
                    where: 'markets_fdv'
                },
                {
                    emoji: 'üí≤',
                    link: 'https://twitter.com/wsbmod',
                    text: 'wsbmod (OTC buyer)',
                    value: 'Negotiated',
                    where: 'point_markets'
                },
                {
                    emoji: 'üí≤',
                    link: 'https://twitter.com/ExitLiqCapital',
                    text: 'otcnick (OTC buyer)',
                    value: 'Negotiated',
                    where: 'point_markets'
                },
                {
                    emoji: 'üêµ',
                    link: 'https://x.com/blocmatesdotcom/status/1861855649778249999/photo/1',
                    text: 'blocmates',
                    value: '$17.50-43.80b',
                    where: 'point_markets'
                },
                {
                    emoji: '‚õàÔ∏è',
                    link: 'https://x.com/tempst0/status/1861697359853347098',
                    text: 'tempst0 (prediction)',
                    value: '$18.13-34.54',
                    where: 'point_markets'
                },
                {
                    emoji: 'üéØ',
                    link: 'https://x.com/Shuri2060',
                    text: 'shuri (prediction, bozo)',
                    value: '$20.00-40.00',
                    where: 'point_markets'
                },
                {
                    emoji: 'üéØ',
                    link: null, // No link provided
                    text: 'vtx (prediction, possibly bozo)',
                    value: '$24.96-24.96',
                    where: 'point_markets'
                },
                {
                    emoji: 'üéØ',
                    link: 'https://x.com/asxn_r/status/1838299623670112749/photo/1',
                    text: 'asxn (prediction)',
                    value: '$5.84-28.96',
                    where: 'point_markets'
                },
                {
                    emoji: 'üéØ',
                    link: 'https://x.com/stevenyuntcap/status/1825928172065665310?t=4pWlevNQPZzZ50PO4ciYfA',
                    text: 'steven.hl (prediction)',
                    value: '$10.00-15.00',
                    where: 'point_markets'
                },
                {
                    emoji: 'üéØ',
                    link: 'https://x.com/defi_monk/status/1854925228096287213/photo/1',
                    text: 'Messari (prediction)',
                    value: '$9.78-27.40',
                    where: 'point_markets'
                },
                {
                    emoji: 'üéØ',
                    link: 'https://x.com/0xPasteke/status/1855727449444692117',
                    text: 'Pasteke.hl (prediction)',
                    value: '$9.00-46.00',
                    where: 'point_markets'
                },
                {
                    emoji: 'üåö',
                    link: 'https://twitter.com/crypto_adair',
                    text: 'adair (moon math)',
                    value: '$799.00-800.00',
                    where: 'point_markets'
                },
                {
                    emoji: 'üåö',
                    link: 'https://www.onchainbinance.com/points',
                    text: 'onchainbinance (moon math)',
                    value: '$0.00-844.00',
                    where: 'point_markets'
                },
                {
                    emoji: 'üåö',
                    link: 'https://twitter.com/GreenGeorgeHL/status/1823398193373032866/photo/1',
                    text: 'GreenGeorgeHL (moon math)',
                    value: '$30.00-86.00',
                    where: 'point_markets'
                },
            ];  
            
        
            const shuffledList = allPredictions.sort(() => Math.random() - 0.5);
            shuffledList.forEach(row => {
                addRow( 
                document.getElementById(row.where) ,
                `<span class="emoji">${row.emoji}</span><a href="${row.link}" target="_blank">${row.text}</a>`,
                 [row.value],
                  15)
            });
        };
        
        predictions()
        

        async function getWithCORS(url_to_get) {
                const CORSurl = 'https://corsproxy.io/?' + encodeURIComponent(url_to_get);
                const response = await fetch(CORSurl);
                const data = await response.json();
                return data
        }
         
        
        async function tryToPopulate(
            emoji, 
            text, 
            link,
            where,
            content_fn, 
            cutoff        
        ) {
            try {        
                value = await content_fn();   
            } catch (error) {
                value = 'Error';
                console.error('Error fetching data:', error);  
            }
            addRow( 
            document.getElementById(where) ,
            `<span class="emoji">${emoji}</span><a href="${link}" target="_blank">${text}</a>`,
             [value],
              cutoff);    
            updatePointFDVBasedOnSliderAndValues()
        }
        
        
        async function fetchBubblyPrice() { 
            const data = await getWithCORS('https://api.bubbly.finance/data/v1/42161/price?address=0x807125cD6599d1f7CA5529dB78951A2828E2A948');
            return `$${parseFloat(data.data.usdPrice).toFixed(2)}`;
        } 
        tryToPopulate(
            "ü´ß",
            "bubbly.finance (market)",
            "https://app.bubbly.finance/swap",
            "point_markets",
            fetchBubblyPrice,
            15
         ) 
        
        
        async function fetchWhalesPrice() { 
            const dataBids = await getWithCORS('https://api.whales.market/v2/offers?symbol=Hyperliquid&status=open&type=buy&take=2');
            const bestBid = Math.max(...dataBids.data.list.map(item => item.offer_price_usd)).toFixed(2);
                
            const dataAsks = await getWithCORS('https://api.whales.market/v2/offers?symbol=Hyperliquid&status=open&type=sell&take=2');
            const bestAsk = Math.min(...dataAsks.data.list.map(item => item.offer_price_usd)).toFixed(2);
    
            return `$${bestBid}-${bestAsk}`;
        }
        tryToPopulate(
            "üêã",
            "whales.market (market)",
            "https://pro.whales.market/points/Arbitrum/Hyperliquid",
            "point_markets",
            fetchWhalesPrice,
            15
         ) 
         
         
        async function fetchCachedHfunPrice() { 
                const response = await fetch('https://stalequant.github.io/stale_prices.json?Math.random()');
                const data = await response.json();
                return  `${data['date']} ->  $${data['hf'].toFixed(2)}`;
        }
        
        tryToPopulate(
            "ü§ñ",
            "Hypurrfun  (market)",
            "https://app.hypurr.fun/launch/262",
            "point_markets",
            fetchCachedHfunPrice,
            15
         ) 
         

        let gateBid = 0;
        let gateAsk = 0;         

        let aevoBid = 0;
        let aevoAsk = 0;     
          
        let compsBid = 0;
        let compsAsk = 0;         
 

        window.onload = function() {
            updatePointFDVBasedOnSliderAndValues(document.getElementById('mySlider').value);
        };


        async function fetchGatePrice() { 
            const AsksData = await getWithCORS('https://www.gate.io/apiw/v2/pre_market/market_orders?page=1&limit=50&currency=HYPE&side=sell&status=no_transaction');
            gateAsk = Number(AsksData['data']['list'][0]['price'])*100;

            const BidsData = await getWithCORS('https://www.gate.io/apiw/v2/pre_market/market_orders?page=1&limit=50&currency=HYPE&side=buy&status=no_transaction');
            gateBid = Number(BidsData['data']['list'][0]['price'])*100;

            return `$${gateBid.toFixed(2)}-${gateAsk.toFixed(2)}b`;
        };
            
        tryToPopulate(
            "‚õ©Ô∏è",
            "Gate.io (market)",
            "https://www.gate.io/pre-market/HYPE",
            "markets_fdv",
            fetchGatePrice,
            15
         )  ;

        async function fetchAevoPrice () { 
            const url = 'https://api.codetabs.com/v1/proxy/?quest=https://api.aevo.xyz/orderbook?instrument_name=HYPE-PERP';
        
            const response = await fetch(url);
            const parsedData = await response.json();
            
            aevoBid = Number(parsedData['bids'][0][0]);
            aevoAsk = Number(parsedData['asks'][0][0]);

            return `$${aevoBid.toFixed(2)}-${aevoAsk.toFixed(2)}b`;
        };
        tryToPopulate(
            "üí©",
            "AEVO (market)",
            "https://app.aevo.xyz/perpetual/hype",
            "markets_fdv",
            fetchAevoPrice,
            15
         )  ;
          
      	async function getPolyMarketMarket(contract){
          const urlA = `https://clob.polymarket.com/prices-history?interval=all&market=${contract}&fidelity=1440`;
          const responseA = await getWithCORS(urlA);
          return responseA.history[responseA.history.length - 1].p;
        };
        
        async function fetchPolyMarketRange() {
            const  priceDec = await getPolyMarketMarket('26267050159315439486982580768550885697032925848336364008331950815706337554671');
            const  priceNov = await getPolyMarketMarket('110636950979938146031820507807868392824912117333231960735063304350353705231383');
            const  priceLater = await getPolyMarketMarket('95247952138809682511168942957507572432766807567801093061883529031657734111365');

            const scaledNov = priceNov / (priceDec+ priceNov + priceLater)
            const scaledDec = priceDec / (priceDec+ priceNov + priceLater) 
            const scaledLater = priceLater / (priceDec+ priceNov + priceLater) 
          
            return `November: ${(scaledNov*100).toFixed(0)}%<br> December: ${(scaledDec*100).toFixed(0)}%<br> Later: ${(scaledLater*100).toFixed(0)}%`;
        };   

        tryToPopulate(
            "üîÆ",
            "Polymarket (market)",
            "https://polymarket.com/event/hyperliquid-token-launch-wen?tid=1732733387137",
            "markets_tgedate",
            fetchPolyMarketRange,
            15
         )  ;
          
        function updateFromSlider(name, low, high){
            if ((low > 0) &  (high > 0)) { 
                try {
                    document.getElementById(name).textContent = `$${(low).toFixed(2)}-${(high).toFixed(2)}`;
                } catch (error) {
                    document.getElementById(name).textContent = 'Failed';
                }        
            }
        };
        
        function updatePointFDVBasedOnSliderAndValues(){       
            let sliderValue = document.getElementById('mySlider').value;
            document.getElementById('sliderValue').textContent = sliderValue + "%";
            let fdvCoeff = 1000/58*sliderValue/100;
            updateFromSlider( 'gateI', gateBid*fdvCoeff, gateAsk*fdvCoeff)
            updateFromSlider( 'compsI', compsBid*fdvCoeff, compsAsk*fdvCoeff)
            updateFromSlider( 'aevoI', aevoBid*fdvCoeff, aevoAsk*fdvCoeff)
        }


        async function populateComps() {
            const urlGecko = 'https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=dydx-chain%2Caevo-exchange%2Cdrift-protocol%2Cgmx%2Craydium%2Cuniswap';
            const urlLlama = 'https://api.llama.fi/protocols';
            const urlLlama2 = 'https://api.llama.fi/overview/derivatives?excludeTotalDataChartBreakdown=true&excludeTotalDataChart=true';
            const urlLlama3 = 'https://api.llama.fi/overview/dexs/All?excludeTotalDataChart=true&excludeTotalDataChartBreakdown=false';

            const [geckoData, llamaData, llamaData2, llamaData3] = await Promise.all([
                fetch(urlGecko).then(response => response.json()),
                fetch(urlLlama).then(response => response.json()),
                fetch(urlLlama2).then(response => response.json()),
                fetch(urlLlama3).then(response => response.json())
            ]);

            const llamaDict = Object.fromEntries(llamaData.map(a => [a.name, a]));
            const llama2Dict = Object.fromEntries(llamaData2.protocols.map(a => [a.name, a]));
            const llama3Dict = Object.fromEntries(llamaData3.protocols.map(a => [a.name, a]));
            const geckoDict = Object.fromEntries(geckoData.map(a => [a.id, a]));

            const baseName = ['Hyperliquid Perp'];
            const nameMap = [
                ['<span class="emoji">üí©</span>Aevo', ['Aevo Perps', 'Aevo Options'], 'aevo-exchange'],
                ['<span class="emoji">üåä</span>Drift', ['Drift Trade', 'Drift AMM'], 'drift-protocol'],
                ['<span class="emoji">‚úñÔ∏è</span>dYdX', ['dYdX V4'], 'dydx-chain'],
                ['<span class="emoji">‚èèÔ∏è</span>GMX', ['GMX V2 Perps'], 'gmx'],
                ['<span class="emoji">üî´</span>Raydium', ['Raydium'], 'raydium'],
                ['<span class="emoji">ü¶Ñ</span>Uniswap', ['Uniswap V3', 'Uniswap V2', 'Uniswap V1', 'Uniswap Labs'], 'uniswap']
            ];

            function getExchMetrics(llamaNames) {
                const output = { tvl: 0, v1d: 0, v7d: 0, v30d: 0 };
                for (const llamaName of llamaNames) {
                    const llama = llamaDict[llamaName];
                    const llama2 = llama2Dict[llamaName];
                    const llama3 = llama3Dict[llamaName];
                    
                    // Accumulate TVL from llamaDict
                    if (llama && llama.tvl) {
                        output.tvl += parseFloat(llama.tvl) || 0;
                    }

                    // Accumulate volume metrics from llama2Dict and llama3Dict
                    if (llama2) {
                        output.v1d += parseFloat(llama2.total24h) || 0;
                        output.v7d += (parseFloat(llama2.total7d) || 0) / 7;
                        output.v30d += (parseFloat(llama2.total30d) || 0) / 30;
                    }
                    if (llama3) {
                        output.v1d += parseFloat(llama3.total24h) || 0;
                        output.v7d += (parseFloat(llama3.total7d) || 0) / 7;
                        output.v30d += (parseFloat(llama3.total30d) || 0) / 30;
                    }
                }
                return output;
            }

            function normMetrics(base, comp, mult) {
                const allMetrics = {};
                for (const metric in base) {
                    allMetrics[metric] = (base[metric] / comp[metric]) * mult;
                }
                return allMetrics;
            }

            const hlMetrics = getExchMetrics(baseName);
            
            let allComps = []

            for (const [printName, llamaNames, geckoName] of nameMap) {
                const compMetrics = getExchMetrics(llamaNames);

                metrics = normMetrics(hlMetrics, compMetrics, geckoDict[geckoName].fully_diluted_valuation / 1e9)
                target = document.getElementById('comparables_fdv');
                addRow( target, `${printName}`, [Number(metrics['tvl']), Number(metrics['v7d'])], 5)
                allComps.push(Number(metrics['tvl']))
                allComps.push(Number(metrics['v7d']))
                
                metrics = normMetrics(hlMetrics, compMetrics, geckoDict[geckoName].market_cap / 1e9)
                target = document.getElementById('comparables_mc');
                addRow( target, `${printName}`, [Number(metrics['tvl']), Number(metrics['v7d'])], 5)

            }
                    
            allComps.sort((a, b) => a - b);
            
            // Calculate the index for the 25th percentile
            compsBid = allComps[Math.floor(0.25 * (allComps.length - 1))]
            compsAsk = allComps[Math.ceil(0.75 * (allComps.length - 1))]
        
            target = document.getElementById('comparables_fdv');
            addRow( target, `<span class="emoji">üßÆ</span>Overall 25th percentile`, ['',compsBid], 15) ;
            addRow( target, `<span class="emoji">üßÆ</span>Overall 75th percentile`, ['',compsAsk], 15) ;


            target = document.getElementById('markets_fdv');
            value =  `$${compsBid.toFixed(2)}-${compsAsk.toFixed(2)}b`;
            addRow( target, `<span class="emoji">üßÆ</span><a href="https://www.investopedia.com/articles/investing/080913/equity-valuation-comparables-approach.asp" target="_blank">Comps (calculated below)</a>`, [value], 15) ;
            
            updatePointFDVBasedOnSliderAndValues()

        }
        
        function addRow(table, name, prices, cutoff=null){
            const row = table.insertRow(0);
            const nameCell = document.createElement('td');
            nameCell.innerHTML  = name;
            row.appendChild(nameCell);
            
            for (const price of prices) {         
                const cell = document.createElement('td');
                cell.classList.add("price-cell");
                if (price == null){
                      cell.textContent = 'N/A';
                      cell.style.backgroundColor = '#f0f0f0'; 
                } else if (typeof price === 'number' ) {
                      cell.textContent = `$${price.toFixed(2)}b`;
                      if (cutoff != null && price > cutoff) {
                         cell.style.backgroundColor =  '#003e00';
                       } 
                } else {
                    cell.innerHTML = price;  
                                    
                }      
                row.appendChild(cell);
            }
        }


        populateComps();
    </script>
</body>
</html>
